<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Roblox R6 Mobile Control</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<style>
html,body{margin:0;overflow:hidden;background:#000;font-family:sans-serif}

/* ì¡°ì´ìŠ¤í‹± */
#joystickBase{
  position:fixed;left:40px;bottom:40px;
  width:120px;height:120px;
  border-radius:50%;
  background:rgba(255,255,255,.15);
  z-index:10;
}
#joystickStick{
  position:absolute;left:40px;top:40px;
  width:40px;height:40px;
  border-radius:50%;
  background:rgba(255,255,255,.5);
}

/* ë²„íŠ¼ */
button{
  position:fixed;right:20px;
  padding:12px;border:none;
  border-radius:12px;font-size:18px;
  z-index:10
}
#shoot{bottom:20px}
#jump{bottom:80px}
#switch{bottom:140px}
</style>
</head>
<body>

<div id="joystickBase">
  <div id="joystickStick"></div>
</div>

<button id="shoot">ğŸ”«</button>
<button id="jump">â¤´ï¸</button>
<button id="switch">ğŸ”</button>

<script src="https://cdn.jsdelivr.net/npm/three@0.155.0/build/three.min.js"></script>
<script>
/* ===== THREE ===== */
const scene=new THREE.Scene();
scene.background=new THREE.Color(0xcfa46a);

const camera=new THREE.PerspectiveCamera(70,innerWidth/innerHeight,0.1,300);
camera.position.set(0,6,10);

const renderer=new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth,innerHeight);
document.body.appendChild(renderer.domElement);

scene.add(new THREE.AmbientLight(0xffffff,.7));
const sun=new THREE.DirectionalLight(0xffffff,1);
sun.position.set(20,40,20);
scene.add(sun);

/* ë•… */
const ground=new THREE.Mesh(
  new THREE.PlaneGeometry(300,300),
  new THREE.MeshStandardMaterial({color:0xc2a46d})
);
ground.rotation.x=-Math.PI/2;
scene.add(ground);

/* ===== í”Œë ˆì´ì–´ ===== */
const player=new THREE.Group();
scene.add(player);

const body=new THREE.Mesh(
  new THREE.BoxGeometry(2,2,1),
  new THREE.MeshStandardMaterial({color:0x8b5a2b})
);
body.position.y=2;
player.add(body);

/* ===== ì´ë™ ë³€ìˆ˜ ===== */
let moveX=0, moveZ=0;

/* ===== ì¡°ì´ìŠ¤í‹± ===== */
const base=document.getElementById("joystickBase");
const stick=document.getElementById("joystickStick");
let joyActive=false;
let joyCenter={x:0,y:0};

base.addEventListener("touchstart",e=>{
  joyActive=true;
  const t=e.touches[0];
  joyCenter.x=t.clientX;
  joyCenter.y=t.clientY;
});

base.addEventListener("touchmove",e=>{
  if(!joyActive)return;
  const t=e.touches[0];
  let dx=t.clientX-joyCenter.x;
  let dy=t.clientY-joyCenter.y;
  const dist=Math.min(40,Math.hypot(dx,dy));
  const angle=Math.atan2(dy,dx);

  stick.style.left=40+Math.cos(angle)*dist+"px";
  stick.style.top =40+Math.sin(angle)*dist+"px";

  moveX=Math.cos(angle)*(dist/40)*0.15;
  moveZ=Math.sin(angle)*(dist/40)*0.15;
});

base.addEventListener("touchend",()=>{
  joyActive=false;
  stick.style.left="40px";
  stick.style.top ="40px";
  moveX=moveZ=0;
});

/* ===== ì‹œì  ë“œë˜ê·¸ (ì˜¤ë¥¸ìª½ í™”ë©´ë§Œ) ===== */
let lookY=0;
document.addEventListener("touchmove",e=>{
  if(e.touches[0].clientX<innerWidth/2) return;
  lookY -= e.touches[0].movementX*0.002;
});

/* ===== ì í”„ ===== */
let vy=0,jumping=false;
document.getElementById("jump").onclick=()=>{
  if(!jumping){vy=0.3;jumping=true;}
};

/* ===== ë£¨í”„ ===== */
function animate(){
  requestAnimationFrame(animate);

  /* ì´ë™ */
  player.position.x += moveX*Math.cos(lookY) - moveZ*Math.sin(lookY);
  player.position.z += moveZ*Math.cos(lookY) + moveX*Math.sin(lookY);

  /* ì í”„ */
  if(jumping){
    player.position.y+=vy;
    vy-=0.02;
    if(player.position.y<=0){
      player.position.y=0;
      jumping=false;
    }
  }

  /* ì¹´ë©”ë¼ */
  camera.position.x = player.position.x + Math.sin(lookY)*8;
  camera.position.z = player.position.z + Math.cos(lookY)*8;
  camera.lookAt(player.position.x,2,player.position.z);

  renderer.render(scene,camera);
}
animate();
</script>
</body>
</html>