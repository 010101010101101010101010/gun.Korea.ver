<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Roblox R6 Western</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<style>
html,body{margin:0;overflow:hidden;font-family:sans-serif;background:#000}

/* UI */
.panel{position:fixed;left:10px;background:rgba(0,0,0,.6);color:#fff;
padding:6px 10px;border-radius:8px;z-index:10}
#ammo{top:50px}
#weapon{top:90px}

/* Î≤ÑÌäº */
button{position:fixed;right:20px;padding:10px 14px;
border:none;border-radius:10px;font-size:16px;z-index:10}
#shoot{bottom:20px}
#switch{bottom:80px}

/* Î°úÎπÑ */
#lobby{
  position:fixed;inset:0;background:rgba(0,0,0,.85);
  display:flex;flex-direction:column;
  align-items:center;justify-content:center;
  color:white;z-index:20
}
input{padding:10px;font-size:18px;border-radius:8px;border:none}
</style>
</head>
<body>

<div class="panel" id="ammo"></div>
<div class="panel" id="weapon"></div>

<button id="shoot">üî´</button>
<button id="switch">üîÅ</button>

<div id="lobby">
  <h2>ÎãâÎÑ§ÏûÑ ÏûÖÎ†•</h2>
  <input id="nameInput" placeholder="Your name">
  <button onclick="start()">Í≤åÏûÑ ÏãúÏûë</button>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.155.0/build/three.min.js"></script>
<script>
/* ===== ÎãâÎÑ§ÏûÑ ===== */
let nickname=localStorage.getItem("nick");
function start(){
  const v=document.getElementById("nameInput").value;
  if(v){nickname=v;localStorage.setItem("nick",v);}
  document.getElementById("lobby").style.display="none";
}
if(nickname) document.getElementById("lobby").style.display="none";

/* ===== THREE ===== */
const scene=new THREE.Scene();
scene.background=new THREE.Color(0xcfa46a);

const camera=new THREE.PerspectiveCamera(70,innerWidth/innerHeight,0.1,300);
camera.position.set(0,6,10);

const renderer=new THREE.WebGLRenderer({antialias:true});
renderer.setSize(innerWidth,innerHeight);
document.body.appendChild(renderer.domElement);

scene.add(new THREE.AmbientLight(0xffffff,.7));
const sun=new THREE.DirectionalLight(0xffffff,1);
sun.position.set(20,40,20);scene.add(sun);

const ground=new THREE.Mesh(
  new THREE.PlaneGeometry(300,300),
  new THREE.MeshStandardMaterial({color:0xc2a46d})
);
ground.rotation.x=-Math.PI/2;scene.add(ground);

/* ===== ÌîåÎ†àÏù¥Ïñ¥ (R6 ÎπÑÏú®) ===== */
const player=new THREE.Group();scene.add(player);

const head=new THREE.Mesh(new THREE.BoxGeometry(2,1,1),
  new THREE.MeshStandardMaterial({color:0xffdbac}));
head.position.y=4.5;player.add(head);

const torso=new THREE.Mesh(new THREE.BoxGeometry(2,2,1),
  new THREE.MeshStandardMaterial({color:0x8b5a2b}));
torso.position.y=3;player.add(torso);

const rightArm=new THREE.Mesh(new THREE.BoxGeometry(1,2,1),
  new THREE.MeshStandardMaterial({color:0xffdbac}));
rightArm.position.set(1.5,3,0);player.add(rightArm);

const leftArm=rightArm.clone();
leftArm.position.x=-1.5;player.add(leftArm);

function leg(x){
  const l=new THREE.Mesh(new THREE.BoxGeometry(1,2,1),
    new THREE.MeshStandardMaterial({color:0x444}));
  l.position.set(x,1,0);player.add(l);
}
leg(-0.5);leg(0.5);

/* ===== ÎãâÎÑ§ÏûÑ ÌëúÏãú ===== */
const nameCanvas=document.createElement("canvas");
nameCanvas.width=256;nameCanvas.height=64;
const ctx=nameCanvas.getContext("2d");
ctx.fillStyle="white";ctx.font="30px Arial";
ctx.textAlign="center";
ctx.fillText(nickname||"Player",128,40);

const nameTex=new THREE.CanvasTexture(nameCanvas);
const nameTag=new THREE.Sprite(
  new THREE.SpriteMaterial({map:nameTex})
);
nameTag.scale.set(4,1,1);
nameTag.position.y=5.5;
player.add(nameTag);

/* ===== Ï≤¥Î†•Î∞î ===== */
let hp=100;
const hpBarBG=new THREE.Mesh(
  new THREE.PlaneGeometry(3,0.3),
  new THREE.MeshBasicMaterial({color:0x000000})
);
hpBarBG.position.y=5;player.add(hpBarBG);

const hpBar=new THREE.Mesh(
  new THREE.PlaneGeometry(3,0.3),
  new THREE.MeshBasicMaterial({color:0x00ff00})
);
hpBar.position.z=0.01;
hpBarBG.add(hpBar);

/* ===== Ï¥ù ===== */
const gun=new THREE.Mesh(
  new THREE.BoxGeometry(1,0.3,0.3),
  new THREE.MeshStandardMaterial({color:0x222})
);
gun.position.set(0,-1,0.8);
rightArm.add(gun);

/* ===== Î¨¥Í∏∞ ÏãúÏä§ÌÖú ===== */
const weapons={
  revolver:{ammo:6,damage:25},
  shotgun:{ammo:2,damage:60}
};
let current="revolver";
let ammo=weapons[current].ammo;

function updateUI(){
  document.getElementById("ammo").innerText=`ÌÉÑÏïΩ ${ammo}`;
  document.getElementById("weapon").innerText=`Î¨¥Í∏∞ ${current}`;
}
updateUI();

/* ===== Î∞úÏÇ¨ ===== */
function shoot(){
  if(ammo<=0)return;
  ammo--;
  updateUI();

  // ÌîºÍ≤© ÌÖåÏä§Ìä∏ (ÏûêÍ∏∞ ÏûêÏã†)
  hp-=weapons[current].damage;
  if(hp<0)hp=0;
  hpBar.scale.x=hp/100;
  if(hp===0) player.visible=false;
}

/* ===== Ï¥ù ÍµêÏ≤¥ ===== */
document.getElementById("switch").onclick=()=>{
  current=current==="revolver"?"shotgun":"revolver";
  ammo=weapons[current].ammo;
  updateUI();
};
document.getElementById("shoot").onclick=shoot;

/* ===== Î£®ÌîÑ ===== */
function animate(){
  requestAnimationFrame(animate);
  camera.lookAt(player.position.x,3,player.position.z);
  renderer.render(scene,camera);
}
animate();
</script>
</body>
</html>